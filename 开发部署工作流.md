# Coach Daily - å¼€å‘éƒ¨ç½²å·¥ä½œæµæŒ‡å—

## ç›®å½•
- [ä¸»æµå¼€å‘æ¨¡å¼](#ä¸»æµå¼€å‘æ¨¡å¼)
- [å®Œæ•´å·¥ä½œæµç¨‹](#å®Œæ•´å·¥ä½œæµç¨‹)
- [æœ¬åœ°å¼€å‘ç¯å¢ƒæ­å»º](#æœ¬åœ°å¼€å‘ç¯å¢ƒæ­å»º)
- [Gitç‰ˆæœ¬æ§åˆ¶é…ç½®](#gitç‰ˆæœ¬æ§åˆ¶é…ç½®)
- [é¦–æ¬¡éƒ¨ç½²æµç¨‹](#é¦–æ¬¡éƒ¨ç½²æµç¨‹)
- [æ—¥å¸¸å¼€å‘æµç¨‹](#æ—¥å¸¸å¼€å‘æµç¨‹)
- [å¿«é€Ÿéƒ¨ç½²è„šæœ¬](#å¿«é€Ÿéƒ¨ç½²è„šæœ¬)
- [å¸¸è§åœºæ™¯å¤„ç†](#å¸¸è§åœºæ™¯å¤„ç†)

---

## ä¸»æµå¼€å‘æ¨¡å¼

### æ¨èæ–¹æ¡ˆï¼šæœ¬åœ°å¼€å‘ + Git + è¿œç¨‹éƒ¨ç½²

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å¼€å‘éƒ¨ç½²å·¥ä½œæµ                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æœ¬åœ°å¼€å‘ (Windows)              ä»£ç ä»“åº“                  ç”Ÿäº§æœåŠ¡å™¨ (Linux)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”€â”€â”€â”€â”€â”€â”€â”€â”€                 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  ğŸ“ ç¼–å†™ä»£ç 
     â†“
  ğŸ§ª æœ¬åœ°æµ‹è¯•
     â†“
  git add .
  git commit
     â†“
  git push         â†’â†’â†’â†’â†’    GitHub/Gitee    â†’â†’â†’â†’â†’     git pull
                           (ä»£ç æ‰˜ç®¡)                   éƒ¨ç½²æ›´æ–°
                                                         pm2 restart
```

### ä¸ºä»€ä¹ˆè¿™æ ·åšï¼Ÿ

âœ… **ä¼˜ç‚¹ï¼š**
1. **èˆ’é€‚çš„å¼€å‘ç¯å¢ƒ**ï¼šWindowsä¸Šæœ‰æ›´å¥½çš„IDEã€å·¥å…·
2. **å®‰å…¨**ï¼šä¸ä¼šå› ä¸ºå¼€å‘å¤±è¯¯å½±å“ç”Ÿäº§ç¯å¢ƒ
3. **ç‰ˆæœ¬æ§åˆ¶**ï¼šæ‰€æœ‰ä¿®æ”¹éƒ½æœ‰è®°å½•ï¼Œå¯ä»¥éšæ—¶å›æ»š
4. **å›¢é˜Ÿåä½œ**ï¼šå…¶ä»–äººä¹Ÿå¯ä»¥å‚ä¸å¼€å‘
5. **è‡ªåŠ¨åŒ–**ï¼šå¯ä»¥é…ç½®CI/CDè‡ªåŠ¨éƒ¨ç½²

âŒ **ä¸æ¨èï¼šç›´æ¥åœ¨æœåŠ¡å™¨ä¸Šå¼€å‘**
- æ²¡æœ‰ç‰ˆæœ¬æ§åˆ¶
- å®¹æ˜“è¯¯æ“ä½œå½±å“ç”Ÿäº§ç¯å¢ƒ
- ç¼–è¾‘ä½“éªŒå·®ï¼ˆvim/nanoï¼‰
- æ— æ³•æœ¬åœ°æµ‹è¯•

---

## å®Œæ•´å·¥ä½œæµç¨‹

### ç¬¬ä¸€æ¬¡éƒ¨ç½²ï¼ˆåˆå§‹åŒ–ï¼‰

```bash
1. æœ¬åœ°å¼€å‘å®Œæˆ
2. åˆå§‹åŒ–Gitä»“åº“
3. æ¨é€åˆ°ä»£ç æ‰˜ç®¡å¹³å°ï¼ˆGitHub/Giteeï¼‰
4. åœ¨æœåŠ¡å™¨ä¸Šå…‹éš†ä»£ç 
5. é…ç½®ç¯å¢ƒå˜é‡
6. å¯åŠ¨æœåŠ¡
```

### åç»­ä¿®æ”¹ï¼ˆæ—¥å¸¸å¼€å‘ï¼‰

```bash
1. æœ¬åœ°ä¿®æ”¹ä»£ç 
2. æœ¬åœ°æµ‹è¯•é€šè¿‡
3. æäº¤åˆ°Git
4. æ¨é€åˆ°è¿œç¨‹ä»“åº“
5. SSHåˆ°æœåŠ¡å™¨
6. æ‹‰å–æœ€æ–°ä»£ç 
7. é‡å¯æœåŠ¡
```

---

## æœ¬åœ°å¼€å‘ç¯å¢ƒæ­å»º

### æ­¥éª¤1ï¼šå®‰è£…Node.jsï¼ˆWindowsï¼‰

```powershell
# è®¿é—®å®˜ç½‘ä¸‹è½½å®‰è£…åŒ…
https://nodejs.org/

# ä¸‹è½½LTSç‰ˆæœ¬ï¼ˆ18.xï¼‰å¹¶å®‰è£…

# éªŒè¯å®‰è£…
node -v
npm -v
```

### æ­¥éª¤2ï¼šåˆ›å»ºæœåŠ¡å™¨é¡¹ç›®

```powershell
# æ‰“å¼€PowerShellæˆ–CMDï¼Œè¿›å…¥é¡¹ç›®ç›®å½•
cd D:\00_DevProject\caoch_daily

# åˆ›å»ºæœåŠ¡å™¨ç«¯ç›®å½•
mkdir server
cd server

# åˆå§‹åŒ–é¡¹ç›®
npm init -y

# å®‰è£…ä¾èµ–
npm install express better-sqlite3 jsonwebtoken bcryptjs dotenv cors helmet express-rate-limit uuid winston

# å®‰è£…å¼€å‘ä¾èµ–
npm install -D nodemon
```

### æ­¥éª¤3ï¼šåˆ›å»ºé¡¹ç›®ç»“æ„

æˆ‘æ¥å¸®ä½ åˆ›å»ºå®Œæ•´çš„æœåŠ¡å™¨ç«¯é¡¹ç›®æ–‡ä»¶ï¼š

**ç›®å½•ç»“æ„ï¼š**
```
D:\00_DevProject\caoch_daily\
â”œâ”€â”€ server/                      â† æ–°å»ºæœåŠ¡å™¨ç«¯ä»£ç 
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ .env                     â† å¼€å‘ç¯å¢ƒé…ç½®
â”‚   â”œâ”€â”€ .env.production          â† ç”Ÿäº§ç¯å¢ƒé…ç½®
â”‚   â”œâ”€â”€ .gitignore
â”‚   â”œâ”€â”€ ecosystem.config.js
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ index.js
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”‚   â””â”€â”€ database.js
â”‚   â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.js
â”‚   â”‚   â”‚   â””â”€â”€ errorHandler.js
â”‚   â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.js
â”‚   â”‚   â”‚   â”œâ”€â”€ reviews.js
â”‚   â”‚   â”‚   â”œâ”€â”€ workouts.js
â”‚   â”‚   â”‚   â”œâ”€â”€ meals.js
â”‚   â”‚   â”‚   â”œâ”€â”€ sleep.js
â”‚   â”‚   â”‚   â”œâ”€â”€ focus.js
â”‚   â”‚   â”‚   â””â”€â”€ sync.js
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”‚       â””â”€â”€ jwt.js
â”‚   â””â”€â”€ data/                    â† æœ¬åœ°æµ‹è¯•æ•°æ®åº“
â”‚       â””â”€â”€ .gitkeep
â”œâ”€â”€ lib/                         â† åŸæœ‰Flutterä»£ç 
â””â”€â”€ ...
```

### æ­¥éª¤4ï¼šé…ç½®å¼€å‘ç¯å¢ƒ

**.envï¼ˆæœ¬åœ°å¼€å‘é…ç½®ï¼‰ï¼š**
```bash
# å¼€å‘ç¯å¢ƒé…ç½®
PORT=3000
NODE_ENV=development

# JWTé…ç½®ï¼ˆå¼€å‘ç”¨ï¼Œå¯ä»¥ç®€å•ä¸€äº›ï¼‰
JWT_SECRET=dev_secret_key_for_local_testing_only
JWT_EXPIRES_IN=30d

# æ•°æ®åº“é…ç½®
DB_PATH=./data/coach_daily_dev.db

# CORSé…ç½®ï¼ˆå¼€å‘æ—¶å…è®¸æ‰€æœ‰æ¥æºï¼‰
ALLOWED_ORIGINS=*
```

**.env.productionï¼ˆç”Ÿäº§ç¯å¢ƒé…ç½®ï¼‰ï¼š**
```bash
# ç”Ÿäº§ç¯å¢ƒé…ç½®
PORT=3000
NODE_ENV=production

# JWTé…ç½®ï¼ˆç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨å¼ºå¯†é’¥ï¼‰
JWT_SECRET=REPLACE_WITH_PRODUCTION_SECRET_KEY_AT_LEAST_32_CHARS
JWT_EXPIRES_IN=30d

# æ•°æ®åº“é…ç½®
DB_PATH=./data/coach_daily.db

# CORSé…ç½®ï¼ˆç”Ÿäº§ç¯å¢ƒé™åˆ¶æ¥æºï¼‰
ALLOWED_ORIGINS=https://yourdomain.com
```

### æ­¥éª¤5ï¼šé…ç½®npm scripts

ä¿®æ”¹ `server/package.json`ï¼š

```json
{
  "name": "coach-daily-server",
  "version": "1.0.0",
  "description": "Coach Daily API Server",
  "main": "src/index.js",
  "scripts": {
    "start": "node src/index.js",
    "dev": "nodemon src/index.js",
    "test": "node src/index.js"
  },
  "dependencies": {
    "express": "^4.18.2",
    "better-sqlite3": "^9.2.2",
    "jsonwebtoken": "^9.0.2",
    "bcryptjs": "^2.4.3",
    "dotenv": "^16.3.1",
    "cors": "^2.8.5",
    "helmet": "^7.1.0",
    "express-rate-limit": "^7.1.5",
    "uuid": "^9.0.1",
    "winston": "^3.11.0"
  },
  "devDependencies": {
    "nodemon": "^3.0.2"
  }
}
```

### æ­¥éª¤6ï¼šæœ¬åœ°æµ‹è¯•è¿è¡Œ

```powershell
# è¿›å…¥æœåŠ¡å™¨ç›®å½•
cd D:\00_DevProject\caoch_daily\server

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆè‡ªåŠ¨é‡å¯ï¼‰
npm run dev

# åº”è¯¥çœ‹åˆ°è¾“å‡ºï¼š
# Database initialized successfully
# Coach Daily API Server running on port 3000
# Environment: development
```

### æ­¥éª¤7ï¼šæµ‹è¯•APIï¼ˆWindowsæœ¬åœ°ï¼‰

```powershell
# æµ‹è¯•å¥åº·æ£€æŸ¥
curl http://localhost:3000/health

# æˆ–ä½¿ç”¨PowerShell
Invoke-WebRequest -Uri http://localhost:3000/health

# æµ‹è¯•æ³¨å†Œ
Invoke-RestMethod -Uri http://localhost:3000/api/auth/register `
  -Method Post `
  -Headers @{"Content-Type"="application/json"} `
  -Body '{"username":"test","password":"test123"}'
```

**æ¨èï¼šä½¿ç”¨Postmanæˆ–Thunder Clientï¼ˆVS Codeæ’ä»¶ï¼‰æµ‹è¯•API**

---

## Gitç‰ˆæœ¬æ§åˆ¶é…ç½®

### æ­¥éª¤1ï¼šåˆ›å»º.gitignore

åœ¨ `server/.gitignore` ä¸­ï¼š

```gitignore
# ä¾èµ–
node_modules/

# ç¯å¢ƒå˜é‡ï¼ˆé‡è¦ï¼ä¸è¦æäº¤å¯†é’¥ï¼‰
.env
.env.local
.env.production

# æ•°æ®åº“æ–‡ä»¶ï¼ˆæœ¬åœ°å¼€å‘ç”¨ï¼Œä¸æäº¤åˆ°Gitï¼‰
data/*.db
data/*.db-*

# æ—¥å¿—
logs/
*.log

# æ“ä½œç³»ç»Ÿæ–‡ä»¶
.DS_Store
Thumbs.db

# IDEé…ç½®
.vscode/
.idea/
*.swp
*.swo

# PM2
.pm2/
```

### æ­¥éª¤2ï¼šåˆå§‹åŒ–Gitä»“åº“

```powershell
# åœ¨é¡¹ç›®æ ¹ç›®å½•
cd D:\00_DevProject\caoch_daily

# å¦‚æœè¿˜æ²¡æœ‰åˆå§‹åŒ–Git
git init

# æ·»åŠ æœåŠ¡å™¨ç«¯ä»£ç 
git add server/
git commit -m "feat: add server-side API implementation"
```

### æ­¥éª¤3ï¼šæ¨é€åˆ°ä»£ç æ‰˜ç®¡å¹³å°

**é€‰é¡¹Aï¼šGitHubï¼ˆéœ€è¦ç§‘å­¦ä¸Šç½‘ï¼‰**

```powershell
# åœ¨GitHubåˆ›å»ºä»“åº“ï¼šhttps://github.com/new
# ä»“åº“åå¦‚ï¼šcoach-daily

# å…³è”è¿œç¨‹ä»“åº“
git remote add origin https://github.com/ä½ çš„ç”¨æˆ·å/coach-daily.git

# æ¨é€ä»£ç 
git branch -M main
git push -u origin main
```

**é€‰é¡¹Bï¼šGiteeï¼ˆå›½å†…æ¨èï¼Œæ— éœ€ç§‘å­¦ä¸Šç½‘ï¼‰**

```powershell
# åœ¨Giteeåˆ›å»ºä»“åº“ï¼šhttps://gitee.com/projects/new
# ä»“åº“åå¦‚ï¼šcoach-daily

# å…³è”è¿œç¨‹ä»“åº“
git remote add origin https://gitee.com/ä½ çš„ç”¨æˆ·å/coach-daily.git

# æ¨é€ä»£ç 
git branch -M main
git push -u origin main
```

**è®¾ç½®Gitå‡­è¯ï¼ˆé¿å…æ¯æ¬¡è¾“å…¥å¯†ç ï¼‰ï¼š**

```powershell
# ä½¿ç”¨å‡­è¯å­˜å‚¨
git config --global credential.helper store

# ç¬¬ä¸€æ¬¡pushæ—¶è¾“å…¥ç”¨æˆ·åå¯†ç ï¼Œä¹‹åä¼šè®°ä½
git push
```

---

## é¦–æ¬¡éƒ¨ç½²æµç¨‹

### æ­¥éª¤1ï¼šåœ¨æœåŠ¡å™¨ä¸Šå®‰è£…å¿…è¦å·¥å…·

```bash
# SSHè¿æ¥åˆ°æœåŠ¡å™¨
ssh root@your-server-ip

# å®‰è£…Git
apt install -y git  # Ubuntu/Debian
# æˆ–
yum install -y git  # CentOS

# å®‰è£…Node.jsï¼ˆå‚è€ƒå‰é¢çš„æ–‡æ¡£ï¼‰
curl -fsSL https://deb.nodesource.com/setup_18.x | bash -
apt install -y nodejs

# å®‰è£…PM2
npm install -g pm2

# åˆ›å»ºåº”ç”¨ç”¨æˆ·
useradd -m -s /bin/bash coach-daily
su - coach-daily
```

### æ­¥éª¤2ï¼šå…‹éš†ä»£ç 

```bash
# åœ¨æœåŠ¡å™¨ä¸Šå…‹éš†ä»£ç 
cd ~
git clone https://github.com/ä½ çš„ç”¨æˆ·å/coach-daily.git
# æˆ–
git clone https://gitee.com/ä½ çš„ç”¨æˆ·å/coach-daily.git

cd coach-daily/server
```

### æ­¥éª¤3ï¼šé…ç½®ç”Ÿäº§ç¯å¢ƒ

```bash
# å¤åˆ¶ç”Ÿäº§ç¯å¢ƒé…ç½®
cp .env.production .env

# ç¼–è¾‘é…ç½®æ–‡ä»¶
nano .env

# ä¿®æ”¹ä»¥ä¸‹å†…å®¹ï¼š
# 1. JWT_SECRET - ç”Ÿæˆå¼ºå¯†é’¥
# 2. ALLOWED_ORIGINS - è®¾ç½®ä¸ºä½ çš„å®é™…åŸŸå
```

**ç”Ÿæˆç”Ÿäº§ç¯å¢ƒJWTå¯†é’¥ï¼š**

```bash
# ç”Ÿæˆå¼ºå¯†é’¥
openssl rand -base64 32

# å¤åˆ¶ç”Ÿæˆçš„å¯†é’¥åˆ°.envçš„JWT_SECRET
```

### æ­¥éª¤4ï¼šå®‰è£…ä¾èµ–å¹¶å¯åŠ¨

```bash
# å®‰è£…ç”Ÿäº§ä¾èµ–
npm install --production

# ä½¿ç”¨PM2å¯åŠ¨
pm2 start ecosystem.config.js

# æŸ¥çœ‹çŠ¶æ€
pm2 status

# è®¾ç½®å¼€æœºè‡ªå¯
pm2 startup
pm2 save
```

### æ­¥éª¤5ï¼šé…ç½®Nginxå’ŒSSL

å‚è€ƒå‰é¢çš„ã€ŠæœåŠ¡å™¨éƒ¨ç½²é…ç½®æ–‡æ¡£.mdã€‹ä¸­çš„æ­¥éª¤9-12

---

## æ—¥å¸¸å¼€å‘æµç¨‹

### åœºæ™¯1ï¼šä¿®æ”¹ä»£ç 

```powershell
# 1. åœ¨Windowsä¸Šä¿®æ”¹ä»£ç 
# ä¾‹å¦‚ï¼šä¿®æ”¹ server/src/routes/reviews.js

# 2. æœ¬åœ°æµ‹è¯•
cd D:\00_DevProject\caoch_daily\server
npm run dev

# æµ‹è¯•APIæ˜¯å¦æ­£å¸¸
curl http://localhost:3000/api/reviews

# 3. æäº¤ä»£ç 
git add .
git commit -m "fix: update reviews API logic"
git push

# 4. SSHåˆ°æœåŠ¡å™¨
ssh coach-daily@your-server-ip

# 5. æ‹‰å–æœ€æ–°ä»£ç 
cd ~/coach-daily
git pull origin main

# 6. é‡å¯æœåŠ¡
cd server
pm2 restart coach-daily-api

# 7. æŸ¥çœ‹æ—¥å¿—ç¡®è®¤
pm2 logs coach-daily-api --lines 20
```

### åœºæ™¯2ï¼šæ·»åŠ æ–°ä¾èµ–

```powershell
# 1. æœ¬åœ°å®‰è£…ä¾èµ–
cd D:\00_DevProject\caoch_daily\server
npm install new-package

# 2. æäº¤package.jsonå’Œpackage-lock.json
git add package.json package-lock.json
git commit -m "deps: add new-package"
git push

# 3. æœåŠ¡å™¨æ›´æ–°
ssh coach-daily@your-server-ip
cd ~/coach-daily/server
git pull
npm install  # å®‰è£…æ–°ä¾èµ–
pm2 restart coach-daily-api
```

### åœºæ™¯3ï¼šæ•°æ®åº“ç»“æ„å˜æ›´

```powershell
# 1. æœ¬åœ°ä¿®æ”¹ src/config/database.js
# ä¾‹å¦‚ï¼šæ·»åŠ æ–°è¡¨

# 2. æœ¬åœ°æµ‹è¯•ï¼ˆåˆ é™¤å¼€å‘æ•°æ®åº“é‡æ–°åˆå§‹åŒ–ï¼‰
cd D:\00_DevProject\caoch_daily\server
rm data/coach_daily_dev.db
npm run dev  # ä¼šè‡ªåŠ¨åˆ›å»ºæ–°è¡¨ç»“æ„

# 3. æµ‹è¯•æ•°æ®æ“ä½œ

# 4. æäº¤ä»£ç 
git add .
git commit -m "feat: add new table for XXX feature"
git push

# 5. æœåŠ¡å™¨æ›´æ–°ï¼ˆéœ€è¦å¤‡ä»½æ•°æ®åº“ï¼‰
ssh coach-daily@your-server-ip

# å¤‡ä»½ç”Ÿäº§æ•°æ®åº“
cd ~/coach-daily/server
cp data/coach_daily.db data/coach_daily_backup_$(date +%Y%m%d_%H%M%S).db

# æ‹‰å–ä»£ç 
git pull

# åœæ­¢æœåŠ¡
pm2 stop coach-daily-api

# è¿è¡Œæ•°æ®åº“è¿ç§»è„šæœ¬ï¼ˆå¦‚æœæœ‰ï¼‰æˆ–æ‰‹åŠ¨æ‰§è¡ŒSQL
# å¦‚æœéœ€è¦ä¿ç•™æ•°æ®ï¼Œå¯ä»¥å†™è¿ç§»è„šæœ¬

# é‡å¯æœåŠ¡
pm2 restart coach-daily-api
```

---

## å¿«é€Ÿéƒ¨ç½²è„šæœ¬

### æœ¬åœ°å¿«é€Ÿæäº¤è„šæœ¬ï¼ˆWindowsï¼‰

åˆ›å»º `server/commit.bat`ï¼š

```batch
@echo off
echo ================================
echo Coach Daily - Quick Commit
echo ================================

set /p message="Enter commit message: "

echo.
echo [1/3] Adding files...
git add .

echo [2/3] Committing...
git commit -m "%message%"

echo [3/3] Pushing to remote...
git push

echo.
echo âœ“ Done! Now deploy on server with: ./deploy.sh
pause
```

ä½¿ç”¨æ–¹æ³•ï¼š
```powershell
cd D:\00_DevProject\caoch_daily
.\server\commit.bat
```

### æœåŠ¡å™¨å¿«é€Ÿéƒ¨ç½²è„šæœ¬ï¼ˆLinuxï¼‰

åˆ›å»º `server/deploy.sh`ï¼š

```bash
#!/bin/bash

echo "================================"
echo "Coach Daily - Quick Deploy"
echo "================================"

# è¿›å…¥é¡¹ç›®ç›®å½•
cd ~/coach-daily/server

echo ""
echo "[1/5] Pulling latest code..."
git pull origin main

echo ""
echo "[2/5] Installing dependencies..."
npm install --production

echo ""
echo "[3/5] Restarting service..."
pm2 restart coach-daily-api

echo ""
echo "[4/5] Checking status..."
pm2 status

echo ""
echo "[5/5] Viewing logs (Ctrl+C to exit)..."
sleep 2
pm2 logs coach-daily-api --lines 20

echo ""
echo "âœ“ Deploy completed!"
```

æ·»åŠ æ‰§è¡Œæƒé™ï¼š
```bash
chmod +x ~/coach-daily/server/deploy.sh
```

ä½¿ç”¨æ–¹æ³•ï¼š
```bash
ssh coach-daily@your-server-ip
./coach-daily/server/deploy.sh
```

### ä¸€é”®éƒ¨ç½²è„šæœ¬ï¼ˆæœ¬åœ°è§¦å‘è¿œç¨‹éƒ¨ç½²ï¼‰

åˆ›å»º `server/deploy-remote.bat`ï¼ˆWindowsï¼‰ï¼š

```batch
@echo off
echo ================================
echo Remote Deploy to Server
echo ================================

set /p server="Enter server IP or domain: "
set /p user="Enter SSH username (default: coach-daily): "
if "%user%"=="" set user=coach-daily

echo.
echo [1/3] Pushing code to Git...
git push

echo [2/3] Connecting to server...
ssh %user%@%server% "cd ~/coach-daily/server && git pull && npm install --production && pm2 restart coach-daily-api"

echo [3/3] Checking status...
ssh %user%@%server% "pm2 status"

echo.
echo âœ“ Remote deploy completed!
pause
```

æˆ–ä½¿ç”¨PowerShellç‰ˆæœ¬ `server/deploy-remote.ps1`ï¼š

```powershell
param(
    [string]$Server = "",
    [string]$User = "coach-daily"
)

Write-Host "================================" -ForegroundColor Cyan
Write-Host "Remote Deploy to Server" -ForegroundColor Cyan
Write-Host "================================" -ForegroundColor Cyan

if ($Server -eq "") {
    $Server = Read-Host "Enter server IP or domain"
}

Write-Host ""
Write-Host "[1/3] Pushing code to Git..." -ForegroundColor Yellow
git push

Write-Host "[2/3] Connecting to server..." -ForegroundColor Yellow
ssh "${User}@${Server}" "cd ~/coach-daily/server && git pull && npm install --production && pm2 restart coach-daily-api"

Write-Host "[3/3] Checking status..." -ForegroundColor Yellow
ssh "${User}@${Server}" "pm2 status"

Write-Host ""
Write-Host "âœ“ Remote deploy completed!" -ForegroundColor Green
```

ä½¿ç”¨æ–¹æ³•ï¼š
```powershell
# Windows CMD
.\server\deploy-remote.bat

# PowerShell
.\server\deploy-remote.ps1 -Server "your-server.com" -User "coach-daily"
```

---

## å¸¸è§åœºæ™¯å¤„ç†

### åœºæ™¯1ï¼šå›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬

```bash
# æœåŠ¡å™¨ä¸Š
cd ~/coach-daily/server
pm2 stop coach-daily-api

# æŸ¥çœ‹æäº¤å†å²
git log --oneline -5

# å›æ»šåˆ°ä¸Šä¸€ä¸ªæäº¤
git reset --hard HEAD~1

# æˆ–å›æ»šåˆ°æŒ‡å®šæäº¤
git reset --hard commit-hash

pm2 restart coach-daily-api
```

### åœºæ™¯2ï¼šç´§æ€¥ä¿®å¤çº¿ä¸ŠBug

```powershell
# 1. æœ¬åœ°åˆ›å»ºhotfixåˆ†æ”¯
git checkout -b hotfix/critical-bug

# 2. ä¿®å¤bugå¹¶æµ‹è¯•

# 3. æäº¤
git add .
git commit -m "hotfix: fix critical bug in XXX"

# 4. åˆå¹¶åˆ°main
git checkout main
git merge hotfix/critical-bug
git push

# 5. æœåŠ¡å™¨æ›´æ–°
ssh coach-daily@your-server-ip
cd ~/coach-daily/server
git pull
pm2 restart coach-daily-api
```

### åœºæ™¯3ï¼šæŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—

```bash
# å®æ—¶æŸ¥çœ‹æ—¥å¿—
pm2 logs coach-daily-api

# æŸ¥çœ‹æœ€è¿‘100è¡Œæ—¥å¿—
pm2 logs coach-daily-api --lines 100

# åªçœ‹é”™è¯¯æ—¥å¿—
pm2 logs coach-daily-api --err

# æ¸…ç©ºæ—¥å¿—
pm2 flush
```

### åœºæ™¯4ï¼šç¯å¢ƒå˜é‡æ›´æ–°

```bash
# æœåŠ¡å™¨ä¸Šä¿®æ”¹.env
nano ~/coach-daily/server/.env

# ä¿®æ”¹åé‡å¯æœåŠ¡ä½¿å…¶ç”Ÿæ•ˆ
pm2 restart coach-daily-api
```

### åœºæ™¯5ï¼šæ‰¹é‡ä¿®æ”¹å¤šä¸ªæ–‡ä»¶

```powershell
# ä½¿ç”¨VS Codeçš„å…¨å±€æœç´¢æ›¿æ¢åŠŸèƒ½
# Ctrl+Shift+H æ‰“å¼€å…¨å±€æ›¿æ¢

# æäº¤æ‰€æœ‰ä¿®æ”¹
git add .
git commit -m "refactor: rename XXX to YYY"
git push

# æœåŠ¡å™¨æ›´æ–°
ssh coach-daily@your-server-ip "./coach-daily/server/deploy.sh"
```

---

## é«˜çº§æŠ€å·§

### 1. ä½¿ç”¨SSHå¯†é’¥è®¤è¯ï¼ˆå…å¯†ç™»å½•ï¼‰

**Windowsç”ŸæˆSSHå¯†é’¥ï¼š**

```powershell
# åœ¨PowerShellä¸­
ssh-keygen -t ed25519 -C "your-email@example.com"

# ä¸€è·¯å›è½¦ï¼Œå¯†é’¥ä¿å­˜åœ¨ï¼š
# C:\Users\ä½ çš„ç”¨æˆ·å\.ssh\id_ed25519

# å¤åˆ¶å…¬é’¥åˆ°æœåŠ¡å™¨
type C:\Users\ä½ çš„ç”¨æˆ·å\.ssh\id_ed25519.pub | ssh coach-daily@your-server-ip "mkdir -p ~/.ssh && cat >> ~/.ssh/authorized_keys"
```

ç°åœ¨å¯ä»¥å…å¯†ç™»å½•ï¼š
```powershell
ssh coach-daily@your-server-ip  # ä¸éœ€è¦è¾“å…¥å¯†ç 
```

### 2. é…ç½®SSHåˆ«å

ç¼–è¾‘ `C:\Users\ä½ çš„ç”¨æˆ·å\.ssh\config`ï¼š

```
Host coach-server
    HostName your-server-ip
    User coach-daily
    Port 22
    IdentityFile C:\Users\ä½ çš„ç”¨æˆ·å\.ssh\id_ed25519
```

ç°åœ¨å¯ä»¥ç®€åŒ–ç™»å½•ï¼š
```powershell
ssh coach-server  # è‡ªåŠ¨ä½¿ç”¨é…ç½®çš„è¿æ¥ä¿¡æ¯
```

### 3. VS Codeè¿œç¨‹å¼€å‘

å®‰è£… **Remote - SSH** æ’ä»¶ï¼š
1. VS Codeå®‰è£… "Remote - SSH" æ‰©å±•
2. æŒ‰F1ï¼Œè¾“å…¥ "Remote-SSH: Connect to Host"
3. è¾“å…¥ `coach-daily@your-server-ip`
4. ç°åœ¨å¯ä»¥ç›´æ¥åœ¨VS Codeä¸­ç¼–è¾‘æœåŠ¡å™¨æ–‡ä»¶

### 4. è‡ªåŠ¨åŒ–CI/CDï¼ˆé«˜çº§ï¼‰

ä½¿ç”¨GitHub Actionsè‡ªåŠ¨éƒ¨ç½²ï¼š

åˆ›å»º `.github/workflows/deploy.yml`ï¼š

```yaml
name: Deploy to Server

on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Deploy to server
        uses: appleboy/ssh-action@master
        with:
          host: ${{ secrets.SERVER_HOST }}
          username: ${{ secrets.SERVER_USER }}
          key: ${{ secrets.SSH_PRIVATE_KEY }}
          script: |
            cd ~/coach-daily/server
            git pull origin main
            npm install --production
            pm2 restart coach-daily-api
```

åœ¨GitHubä»“åº“è®¾ç½®ä¸­æ·»åŠ Secretsï¼š
- `SERVER_HOST`: æœåŠ¡å™¨IP
- `SERVER_USER`: SSHç”¨æˆ·å
- `SSH_PRIVATE_KEY`: SSHç§é’¥å†…å®¹

ç°åœ¨æ¯æ¬¡pushåˆ°mainåˆ†æ”¯ï¼Œä¼šè‡ªåŠ¨éƒ¨ç½²åˆ°æœåŠ¡å™¨ï¼

---

## æ¨èå·¥å…·

### Windowsæœ¬åœ°å¼€å‘

1. **ä»£ç ç¼–è¾‘å™¨**ï¼š
   - VS Codeï¼ˆæ¨èï¼‰+ æ’ä»¶ï¼š
     - ESLint
     - Prettier
     - Thunder Clientï¼ˆAPIæµ‹è¯•ï¼‰
     - Remote - SSHï¼ˆè¿œç¨‹å¼€å‘ï¼‰

2. **APIæµ‹è¯•å·¥å…·**ï¼š
   - Postmanï¼ˆåŠŸèƒ½å¼ºå¤§ï¼‰
   - Thunder Clientï¼ˆVS Codeæ’ä»¶ï¼Œè½»é‡ï¼‰

3. **Gitå›¾å½¢åŒ–å·¥å…·**ï¼ˆå¯é€‰ï¼‰ï¼š
   - GitKraken
   - SourceTree
   - GitHub Desktop

4. **SSHå®¢æˆ·ç«¯**ï¼š
   - Windows Terminalï¼ˆæ¨èï¼Œè‡ªå¸¦ï¼‰
   - MobaXtermï¼ˆåŠŸèƒ½ä¸°å¯Œï¼‰

### æœåŠ¡å™¨è¿ç»´

1. **æ–‡ä»¶ä¼ è¾“**ï¼š
   - WinSCPï¼ˆå›¾å½¢åŒ–SFTPï¼‰
   - FileZilla

2. **æ•°æ®åº“ç®¡ç†**ï¼š
   - DB Browser for SQLiteï¼ˆæŸ¥çœ‹SQLiteæ•°æ®åº“ï¼‰

---

## å®Œæ•´å·¥ä½œæµç¤ºä¾‹

### éœ€æ±‚ï¼šæ·»åŠ ç”¨æˆ·å¤´åƒä¸Šä¼ åŠŸèƒ½

**ç¬¬1å¤©ï¼šæœ¬åœ°å¼€å‘**

```powershell
# 1. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
cd D:\00_DevProject\caoch_daily
git checkout -b feature/user-avatar

# 2. å®‰è£…æ–°ä¾èµ–ï¼ˆå›¾ç‰‡å¤„ç†ï¼‰
cd server
npm install multer sharp

# 3. ç¼–å†™ä»£ç 
# - æ·»åŠ ä¸Šä¼ è·¯ç”±
# - æ·»åŠ å›¾ç‰‡å¤„ç†é€»è¾‘
# - æ›´æ–°ç”¨æˆ·è¡¨ç»“æ„

# 4. æœ¬åœ°æµ‹è¯•
npm run dev
# ä½¿ç”¨Postmanæµ‹è¯•ä¸Šä¼ æ¥å£

# 5. æäº¤ä»£ç 
git add .
git commit -m "feat: add user avatar upload"
git push origin feature/user-avatar
```

**ç¬¬2å¤©ï¼šä»£ç å®¡æŸ¥å’Œåˆå¹¶**

```powershell
# 1. åœ¨GitHub/Giteeåˆ›å»ºPull Request

# 2. è‡ªå·±å®¡æŸ¥ä»£ç ï¼ˆæˆ–å›¢é˜Ÿæˆå‘˜å®¡æŸ¥ï¼‰

# 3. åˆå¹¶åˆ°mainåˆ†æ”¯
git checkout main
git merge feature/user-avatar
git push origin main

# 4. åˆ é™¤åŠŸèƒ½åˆ†æ”¯
git branch -d feature/user-avatar
```

**ç¬¬3å¤©ï¼šéƒ¨ç½²åˆ°ç”Ÿäº§**

```bash
# 1. SSHåˆ°æœåŠ¡å™¨
ssh coach-server

# 2. æ‹‰å–æœ€æ–°ä»£ç 
cd ~/coach-daily/server
git pull origin main

# 3. å®‰è£…æ–°ä¾èµ–
npm install --production

# 4. å¤‡ä»½æ•°æ®åº“ï¼ˆå› ä¸ºæœ‰è¡¨ç»“æ„å˜æ›´ï¼‰
cp data/coach_daily.db data/coach_daily_backup_$(date +%Y%m%d).db

# 5. é‡å¯æœåŠ¡
pm2 restart coach-daily-api

# 6. æŸ¥çœ‹æ—¥å¿—
pm2 logs coach-daily-api --lines 50

# 7. æµ‹è¯•æ–°åŠŸèƒ½
curl -X POST https://yourdomain.com/api/user/avatar \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -F "avatar=@test.jpg"
```

---

## æ€»ç»“

### æ ‡å‡†å¼€å‘æµç¨‹

```
æœ¬åœ°å¼€å‘ â†’ æœ¬åœ°æµ‹è¯• â†’ Gitæäº¤ â†’ æ¨é€åˆ°è¿œç¨‹ â†’ æœåŠ¡å™¨æ‹‰å– â†’ éƒ¨ç½²æ›´æ–°
```

### æ ¸å¿ƒåŸåˆ™

1. âœ… **æ°¸è¿œåœ¨æœ¬åœ°å¼€å‘å’Œæµ‹è¯•**
2. âœ… **æ‰€æœ‰ä»£ç éƒ½é€šè¿‡Gitç®¡ç†**
3. âœ… **ä¸è¦ç›´æ¥åœ¨æœåŠ¡å™¨ä¸Šä¿®æ”¹ä»£ç **
4. âœ… **éƒ¨ç½²å‰å¤‡ä»½æ•°æ®åº“**
5. âœ… **æŸ¥çœ‹æ—¥å¿—ç¡®è®¤éƒ¨ç½²æˆåŠŸ**

### æ—¶é—´ä¼°ç®—

- **é¦–æ¬¡ç¯å¢ƒæ­å»º**ï¼š2å°æ—¶
- **é¦–æ¬¡éƒ¨ç½²**ï¼š1å°æ—¶
- **æ—¥å¸¸ä»£ç ä¿®æ”¹éƒ¨ç½²**ï¼š5-10åˆ†é’Ÿ
- **ç´§æ€¥bugä¿®å¤**ï¼š15-30åˆ†é’Ÿ

### å¿«é€Ÿå‘½ä»¤å‚è€ƒ

```powershell
# æœ¬åœ°å¼€å‘
npm run dev              # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
git add . && git commit  # æäº¤ä»£ç 
git push                 # æ¨é€åˆ°è¿œç¨‹

# æœåŠ¡å™¨éƒ¨ç½²
ssh coach-server         # è¿æ¥æœåŠ¡å™¨
./deploy.sh              # ä¸€é”®éƒ¨ç½²
pm2 logs                 # æŸ¥çœ‹æ—¥å¿—
pm2 restart api          # é‡å¯æœåŠ¡
```

---

ç°åœ¨ä½ å·²ç»æŒæ¡äº†å®Œæ•´çš„ç°ä»£å¼€å‘å·¥ä½œæµï¼æœ‰ä»»ä½•é—®é¢˜éšæ—¶é—®æˆ‘ã€‚
